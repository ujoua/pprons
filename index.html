<!DOCTYPE html>
<html lang="ko">

<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4750899658093754"
        crossorigin="anonymous"></script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>ğŸ« ë§‰ëŒ€ ê³¼ìë¥¼ ì¡ì•„ë¼! </title>
    <link rel="stylesheet" href="style.css" />
    <style>
        html,
        body {
            margin: 0;
            height: 100vh;
            touch-action: manipulation;
            -ms-touch-action: manipulation;
        }

        h1 {
            color: #5e3023;
            margin-bottom: 20px;
        }

        #game-area {
            position: relative;
            width: 200px;
            height: 400px;
            background: #fff4e6;
            border: 3px solid #d3b89f;
            border-radius: 10px;
            overflow: hidden;
            cursor: pointer;
        }

        #ppr {
            position: absolute;
            top: -150px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 150px;
            background: linear-gradient(to bottom, #4e2a18 70%, #d0a57b 70%);
            border-radius: 5px;
            display: none;
        }

        .touch-point {
            position: absolute;
            width: 30px;
            height: 30px;
            background: rgba(255, 120, 0, 0.6);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            animation: pop 0.4s ease-out forwards;
        }

        @keyframes pop {
            0% {
                transform: translate(-50%, -50%) scale(0.5);
                opacity: 1;
            }

            100% {
                transform: translate(-50%, -50%) scale(1.8);
                opacity: 0;
            }
        }

        #boundary-line {
            position: absolute;
            width: 100%;
            height: 2px;
            background: red;
            display: none;
        }

        #result-screen {
            display: none;
            margin-top: 20px;
            text-align: center;
        }

        #result-screen p {
            font-size: 18px;
            color: #4e2a18;
            margin-bottom: 10px;
        }

        #result-screen button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            color: white;
            background-color: #8b4513;
        }

        /* âœ… ë³µì‚¬ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        #share-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            align-items: center;
            justify-content: center;
            z-index: 999;
        }

        #share-modal .modal-content {
            background: white;
            border-radius: 10px;
            padding: 20px;
            width: 80%;
            max-width: 320px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        #share-modal input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
            margin-bottom: 12px;
        }

        #copy-btn {
            background-color: #8b4513;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 12px;
            cursor: pointer;
            margin-right: 8px;
        }

        #close-btn {
            background-color: #aaa;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 12px;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <header>
        <h1>ğŸ« ë§‰ëŒ€ ê³¼ìë¥¼ ì¡ì•„ë¼!</h1>
        <nav style="display: none;">
            <a href="index.html">ê²Œì„í•˜ê¸°</a>
            <a href="about.html">ì†Œê°œ</a>
            <a href="privacy.html">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
            <a href="contact.html">ë¬¸ì˜</a>
        </nav>
    </header>

    <br />

    <div id="game-area">
        <div id="ppr"></div>
        <div id="boundary-line"></div>
    </div>

    <div id="result-screen">
        <p id="result-text"></p>
        <button id="retry-btn">ë‹¤ì‹œí•˜ê¸°</button>
        <button id="share-btn">ê³µìœ í•˜ê¸°</button>
    </div>

    <!-- âœ… ë³µì‚¬ ëª¨ë‹¬ HTML ì¶”ê°€ -->
    <div id="share-modal">
        <div class="modal-content">
            <p style="font-size:16px; margin-bottom:10px;">ì´ ë§í¬ë¥¼ ë³µì‚¬í•´ì„œ ì¹œêµ¬ì—ê²Œ ë³´ë‚´ì„¸ìš”!</p>
            <input id="share-url-input" readonly />
            <div>
                <button id="copy-btn">ë³µì‚¬í•˜ê¸°</button>
                <button id="close-btn">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        const PPR_WIDTH = 10;
        const PPR_HEIGHT = 200;
        const CHOCO_RATIO = 0.8;

        const gameArea = document.getElementById('game-area');
        const ppr = document.getElementById('ppr');
        const boundaryLine = document.getElementById('boundary-line');
        const resultScreen = document.getElementById('result-screen');
        const resultText = document.getElementById('result-text');
        const retryBtn = document.getElementById('retry-btn');
        const shareBtn = document.getElementById('share-btn');

        let animationFrame;
        let startTime;
        let isFalling = false;
        let lastScore = 0;
        const fallSpeed = 222 * 2.5 + Math.random() * 11;
        const totalHeight = 400;

        ppr.style.width = `${PPR_WIDTH}px`;
        ppr.style.height = `${PPR_HEIGHT}px`;
        ppr.style.background = `linear-gradient(to bottom, #4e2a18 ${CHOCO_RATIO * 100}%, #d0a57b ${CHOCO_RATIO * 100}%)`;

        function startGame() {
            resultScreen.style.display = 'none';
            ppr.style.top = `-${PPR_HEIGHT}px`;
            ppr.style.display = 'block';
            boundaryLine.style.top = `${-PPR_HEIGHT + PPR_HEIGHT * CHOCO_RATIO}px`;
            boundaryLine.style.display = 'block';
            isFalling = false;
            resultText.innerText = '';

            const randomDelay = 1000 + Math.random() * 2000;
            setTimeout(() => {
                startTime = null;
                isFalling = true;
                requestAnimationFrame(fall);
            }, randomDelay);
        }

        function fall(timestamp) {
            if (!startTime) startTime = timestamp;
            const elapsed = (timestamp - startTime) / 1000;
            const distance = elapsed * fallSpeed;

            if (distance < totalHeight) {
                ppr.style.top = `${distance - PPR_HEIGHT}px`;
                animationFrame = requestAnimationFrame(fall);
            } else {
                ppr.style.top = `${totalHeight - PPR_HEIGHT}px`;
                isFalling = false;
                endGame('ë†“ì³¤ì–´ìš”! ğŸ˜­', 0);
            }
        }

        function handleTouch(e) {
            if (!isFalling) return;

            const touch = e.touches ? e.touches[0] : e;
            const clickX = touch.clientX;
            const clickY = touch.clientY;

            const pprRect = ppr.getBoundingClientRect();

            const effect = document.createElement('div');
            effect.classList.add('touch-point');
            effect.style.left = `${clickX - gameArea.getBoundingClientRect().left}px`;
            effect.style.top = `${clickY - gameArea.getBoundingClientRect().top}px`;
            gameArea.appendChild(effect);
            setTimeout(() => { effect.remove(); }, 400);

            if (clickX < pprRect.left || clickX > pprRect.right) {
                endGame('ê³¼ìë¥¼ ë²—ì–´ë‚¬ì–´ìš”! âŒ', 0, clickX, clickY);
                return;
            }

            const boundaryY = pprRect.top + PPR_HEIGHT * CHOCO_RATIO;
            if (pprRect.top < clickY && clickY < boundaryY) {
                endGame('ì´ˆì½”ë¥¼ ì¡ì•˜ì–´ìš”! âŒ', 0, clickX, clickY);
            } else if (clickY < pprRect.top) {
                endGame('ë„ˆë¬´ ëŠ¦ì—ˆì–´ìš”! ğŸ˜¢', 0, clickX, clickY);
            } else if (clickY > pprRect.bottom) {
                endGame('ë„ˆë¬´ ë¹¨ëì–´ìš”! ğŸ˜¢', 0, clickX, clickY);
            } else {
                const distance = Math.abs(clickY - boundaryY);
                const score = Math.max(0, 100 - distance);
                endGame(`ğŸ¯ ì„±ê³µ! ${Math.round(score)}ì  (ìƒìœ„ ${Math.max(1, Math.round(distance / Math.abs(pprRect.bottom - boundaryY) * 100))}%)`, score, clickX, clickY);
            }
        }

        function endGame(msg, score, clickX = null, clickY = null) {
            cancelAnimationFrame(animationFrame);
            isFalling = false;
            lastScore = score;
            resultText.innerText = msg;
            ppr.style.display = 'block';

            if (clickX !== null && clickY !== null) {
                const touch = document.createElement('div');
                touch.classList.add('touch-point');
                touch.style.left = `${clickX - gameArea.getBoundingClientRect().left}px`;
                touch.style.top = `${clickY - gameArea.getBoundingClientRect().top}px`;
                gameArea.appendChild(touch);
            }

            resultScreen.style.display = 'block';
        }

        retryBtn.addEventListener('click', startGame);

        // âœ… ê³µìœ í•˜ê¸° ë²„íŠ¼ ê¸°ëŠ¥
        let roundedScore = 0;
        shareBtn.addEventListener('click', () => {
            roundedScore = Math.round(lastScore);
            const shareUrl = `${window.location.origin}${window.location.pathname}`;
            const shareData = {
                title: 'ë§‰ëŒ€ ê³¼ìë¥¼ ì¡ì•„ë¼! ì´ˆì½œë¦¿ì— ê°€ê¹Œì´ ì¡ì„ ìˆ˜ë¡ ì ìˆ˜ê°€ ì˜¬ë¼ê°€ìš”!',
                text: `ë‚´ ì ìˆ˜ëŠ” ${roundedScore}ì ì´ì•¼!`,
                url: shareUrl
            };

            if (navigator.share) {
                navigator.share(shareData).catch(() => showShareModal(shareUrl));
            } else {
                showShareModal(shareUrl);
            }
        });

        // âœ… ë³µì‚¬ ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜
        function showShareModal(url) {
            const modal = document.getElementById('share-modal');
            const input = document.getElementById('share-url-input');
            const copyBtn = document.getElementById('copy-btn');
            const closeBtn = document.getElementById('close-btn');

            input.value = `ë§‰ëŒ€ ê³¼ìë¥¼ ì¡ì•„ë¼! ì´ˆì½œë¦¿ì— ê°€ê¹Œì´ ì¡ì„ ìˆ˜ë¡ ì ìˆ˜ê°€ ì˜¬ë¼ê°€ìš”! - ë‚´ ì ìˆ˜ëŠ” ${roundedScore}ì ì´ì•¼! ${url}`
            modal.style.display = 'flex';

            copyBtn.onclick = () => {
                navigator.clipboard.writeText(url).then(() => {
                    copyBtn.textContent = 'ë³µì‚¬ ì™„ë£Œ!';
                    setTimeout(() => {
                        modal.style.display = 'none';
                        copyBtn.textContent = 'ë³µì‚¬í•˜ê¸°';
                    }, 800);
                }).catch(() => {
                    alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ì§ì ‘ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
                });
            };

            closeBtn.onclick = () => {
                modal.style.display = 'none';
            };
        }

        // í™•ëŒ€ ë°©ì§€
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (e) => {
            const now = new Date().getTime();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        document.addEventListener('gesturestart', (e) => e.preventDefault());

        startGame();
        gameArea.addEventListener('click', handleTouch);
        gameArea.addEventListener('touchstart', handleTouch);
    </script>
</body>

</html>



